<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SMT Tapping Test</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
    body {
        font-family: Arial, sans-serif;
        background: #f4f8ff;
        text-align: center;
        padding: 30px;
    }

    h1 {
        color: #1a3d8f;
    }

    #tapButton {
        background: #4a79ff;
        color: white;
        border: none;
        padding: 25px 50px;
        font-size: 25px;
        border-radius: 12px;
        margin-top: 40px;
        cursor: pointer;
    }

    #tapButton:active {
        background: #6a92ff;
    }

    #resultsBox {
        margin-top: 40px;
        font-size: 20px;
        padding: 20px;
        background: white;
        border-radius: 10px;
        display: none;
        box-shadow: 0px 0px 10px rgba(0,0,0,0.1);
    }
</style>
</head>

<body>

<h1>Spontaneous Motor Tempo Test</h1>
<p>Tap the button at a comfortable, natural pace (not following any beat or song).</p>
<p>Tap at least 15–20 times. When done, press “Done”.</p>

<button id="tapButton">TAP</button>
<br><br>
<button onclick="finishTest()" style="margin-top:20px; padding:10px 20px; font-size:18px;">Done</button>

<div id="resultsBox">
    <h2>Results</h2>
    <p id="tapCount"></p>
    <p id="bpmValue"></p>
    <p><b>Copy this BPM value into your Google Form.</b></p>
</div>

<script>
let timestamps = [];

document.getElementById("tapButton").addEventListener("click", () => {
    timestamps.push(performance.now());
});

function finishTest() {
    if (timestamps.length < 5) {
        alert("Please tap at least 5–10 times for an accurate SMT reading.");
        return;
    }

    // Calculate inter-tap intervals
    let intervals = [];
    for (let i = 1; i < timestamps.length; i++) {
        intervals.push(timestamps[i] - timestamps[i-1]);
    }

    // Average interval in milliseconds
    let avgInterval = intervals.reduce((a,b) => a+b, 0) / intervals.length;

    // Convert to BPM
    let bpm = 60000 / avgInterval;
    let roundedBpm = Math.round(bpm);

    document.getElementById("resultsBox").style.display = "block";
    document.getElementById("tapCount").innerHTML = "Number of taps: " + timestamps.length;
    document.getElementById("bpmValue").innerHTML = "Your SMT (BPM): <b>" + roundedBpm + "</b>";
}
</script>

</body>
</html>
